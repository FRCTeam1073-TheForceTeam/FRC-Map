
<link rel="stylesheet" href="./css/bootstrap.min.css" type="text/css" media="screen" />
<link rel="stylesheet" href="./css/bootstrap-slider.css" type="text/css" media="screen" />

<script src="./js/jquery.js"></script>
<script src="./js/bootstrap-slider.js"></script>
<script src="./js/modernizr.js"></script>

<script src="./data/geo_coordinates_for_Events_Teams.js"></script>
<script src="./data/team_participation.js"></script>

<script src="./src/dataModel.js"></script>
<script src="./src/mapInterface.js"></script>
<script src="./src/mapSlider.js"></script>

<style>

    /* Always set the map height explicitly to define the size of the div
     * element that contains the map. */
    #map {
      height: 700px;
      width: 100%;
    }
    /* Optional: Makes the sample page fill the window. */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #floating-panel {
      position: absolute;
      top: 10px;
      left: 25%;
      z-index: 5;
      background-color: #fff;
      padding: 5px;
      border: 1px solid #999;
      text-align: center;
      font-family: 'Roboto','sans-serif';
      line-height: 30px;
      padding-left: 10px;
    }

    .slider-example {
      position: absolute;
      top: 60px;
      left: 25%;
      z-index: 5;
      margin: auto;
    }

    .slider.slider-horizontal {
      width: 400px;
      height: 20px;
    }
    .slider-value {
        margin-left: 20px;
    }

</style>


<script type="text/javascript">

var frcInfo;

var toggleTeams = true;
var toggleEvents = true;

function initMap() {

    // create the map instance
    var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 4,
                center: {lat: 42.743, lng: -71.592}
            });

    var geocoder = new google.maps.Geocoder();

    // store the map and geocoder in the overall data model object
    frcInfo.map = map;
    frcInfo.geocoder = geocoder;

    // create all markers for the FRC teams and events 
    mapFrcTeams( frcInfo );
    mapFrcEvents( frcInfo );

    document.getElementById('find_entity').addEventListener('click', function() {
        var entityName = document.getElementById('entity_name').value;

        showFrcTeam( frcInfo, entityName );
    });

    document.getElementById('play_automation').addEventListener('click', function() {

        console.log( "Playing Automation" );

        // hide all events to start
        showFrcEvents( frcInfo, false );

        // start with showing the events of the first year
        frcInfo.currentYear = frcInfo.firstYear;
        
        setTimeout(function(){ automation_callback(); },1000);

    });

    document.getElementById('show_teams').addEventListener('click', function() {
        showFrcTeams(frcInfo, toggleTeams);
        if ( toggleTeams == true ) {
            toggleTeams = false;
        } else {
            toggleTeams = true;
        }
    });
    document.getElementById('show_events').addEventListener('click', function() {
        showFrcEvents(frcInfo, toggleEvents);
        if ( toggleEvents == true ) {
            toggleEvents = false;
        } else {
            toggleEvents = true;
        }
    });
  
}

function automation_callback() {

    console.log( "Showing Events for year " + frcInfo.currentYear );

    if ( frcInfo.currentYear != frcInfo.firstYear ) {
        showFrcEventsByYear( frcInfo, (frcInfo.currentYear-1), false );
    }

    if ( toggleEvents == true )
        showFrcEventsByYear( frcInfo, frcInfo.currentYear, true );

    $("#sliderSliderVal").text(frcInfo.currentYear);
    $("#slider").slider('setValue', frcInfo.currentYear);

    frcInfo.currentYear += 1;

    if ( frcInfo.currentYear <= frcInfo.lastYear ) {
        setTimeout(function(){ automation_callback(); }, 500);
    }

}

$(document).ready(function() {

    frcInfo = new FrcData();

    frcInfo.loadTeamData();
    frcInfo.loadEventData();

    // initialize the slider callback function
    $("#slider").slider();
    $("#slider").on("slide", function(slideEvt) {
        $("#sliderSliderVal").text(slideEvt.value);

        // call the slider event handler, passing in the current FRC info
        mapSliderEvent( frcInfo, slideEvt.value );
    });
    $("#slider").on("slideStop", function(slideEvt) {
        $("#sliderSliderVal").text(slideEvt.value);

        // call the slider event handler, passing in the current FRC info
        mapSliderEvent( frcInfo, slideEvt.value );
    });
});


</script>

<head>
</head>

<body>

    
    <div id="floating-panel">
      <input id="play_automation" type="button" value="Play" class="play-button">
      <input id="find_entity" type="button" value="Find Team">
      <input id="entity_name" type="textbox" value="" size="10">
      <input id="show_teams" type="checkbox" value="Teams"> Teams
      <input id="show_events" type="checkbox" value="Events"> Events
    </div>

    <div class='slider-example'>
        <input id="slider" type="text" data-slider-min="1992" data-slider-max="2017" data-slider-step="1" data-slider-value="2017"/>
        <span class="slider-value" id="sliderCurrentSliderValLabel"> Year: <span id="sliderSliderVal">2017</span></span>
    </div>


    <div id="map"></div>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFv2an3D9y6JBSljMqZYS7e8vosnMmdMk&callback=initMap">
    </script>

</body>
</html>
